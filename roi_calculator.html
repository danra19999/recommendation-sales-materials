<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰æ©Ÿèƒ½å°å…¥ ROIè¨ˆç®—ãƒ„ãƒ¼ãƒ«</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Yu Gothic', 'Meiryo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #667eea;
            font-size: 32px;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 16px;
        }
        
        .section {
            background: #f8f9ff;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .section h2 {
            color: #667eea;
            font-size: 24px;
            margin-bottom: 20px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
        }
        
        .input-group label {
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .input-group input,
        .input-group select {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .input-with-unit {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .input-with-unit input {
            flex: 1;
        }
        
        .unit {
            color: #666;
            font-weight: bold;
            min-width: 60px;
        }
        
        .calculate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: transform 0.2s;
        }
        
        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }
        
        .results {
            display: none;
        }
        
        .results.show {
            display: block;
        }
        
        .result-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .result-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }
        
        .result-card.highlight {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .result-card h3 {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 15px;
        }
        
        .result-card .value {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .result-card .subvalue {
            font-size: 14px;
            opacity: 0.8;
        }
        
        .chart-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .chart-container h3 {
            color: #333;
            font-size: 20px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .comparison-bars {
            display: flex;
            gap: 40px;
            align-items: flex-end;
            justify-content: center;
            height: 300px;
            margin: 30px 0;
        }
        
        .bar-group {
            text-align: center;
            flex: 1;
            max-width: 200px;
        }
        
        .bar {
            background: linear-gradient(to top, #667eea 0%, #764ba2 100%);
            border-radius: 10px 10px 0 0;
            margin: 0 auto 10px;
            width: 100%;
            position: relative;
            transition: all 0.5s ease;
        }
        
        .bar.after {
            background: linear-gradient(to top, #f093fb 0%, #f5576c 100%);
        }
        
        .bar-label {
            position: absolute;
            top: -30px;
            left: 0;
            right: 0;
            font-weight: bold;
            color: #333;
            font-size: 18px;
        }
        
        .bar-title {
            font-weight: bold;
            color: #333;
            margin-top: 10px;
        }
        
        .scenario-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .scenario-table th,
        .scenario-table td {
            padding: 15px;
            text-align: center;
            border: 1px solid #ddd;
        }
        
        .scenario-table th {
            background: #667eea;
            color: white;
            font-weight: bold;
        }
        
        .scenario-table tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        .scenario-table .best {
            background: #e8f5e9;
            font-weight: bold;
        }
        
        .info-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 20px;
            border-radius: 5px;
            margin-top: 20px;
        }
        
        .info-box h4 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .info-box p {
            color: #856404;
            line-height: 1.6;
        }
        
        .export-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        .export-btn {
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .export-btn:hover {
            background: #667eea;
            color: white;
        }

        .recommendation {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
        }

        .recommendation h3 {
            font-size: 24px;
            margin-bottom: 15px;
        }

        .recommendation p {
            font-size: 18px;
            line-height: 1.6;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
            }
            .calculate-btn, .export-buttons {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰æ©Ÿèƒ½å°å…¥ ROIè¨ˆç®—ãƒ„ãƒ¼ãƒ«</h1>
        <p class="subtitle">å¾¡ç¤¾ã®æ•°å€¤ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€å°å…¥åŠ¹æœã¨æŠ•è³‡å›åæœŸé–“ã‚’è‡ªå‹•è¨ˆç®—ã—ã¾ã™</p>
        
        <div class="section">
            <h2>1. ç¾åœ¨ã®äº‹æ¥­æ•°å€¤ã‚’å…¥åŠ›</h2>
            <div class="input-grid">
                <div class="input-group">
                    <label>æœˆå•†ï¼ˆä¸‡å††ï¼‰</label>
                    <div class="input-with-unit">
                        <input type="number" id="monthlySales" value="1000" min="0">
                        <span class="unit">ä¸‡å††</span>
                    </div>
                </div>
                
                <div class="input-group">
                    <label>ç²—åˆ©ç‡ï¼ˆ%ï¼‰</label>
                    <div class="input-with-unit">
                        <input type="number" id="grossMargin" value="40" min="0" max="100">
                        <span class="unit">%</span>
                    </div>
                </div>
                
                <div class="input-group">
                    <label>æœˆé–“è¨ªå•è€…æ•°ï¼ˆäººï¼‰</label>
                    <div class="input-with-unit">
                        <input type="number" id="monthlyVisitors" value="10000" min="0">
                        <span class="unit">äºº</span>
                    </div>
                </div>
                
                <div class="input-group">
                    <label>ç¾åœ¨ã®è³¼å…¥ç‡ï¼ˆ%ï¼‰</label>
                    <div class="input-with-unit">
                        <input type="number" id="conversionRate" value="2" min="0" max="100" step="0.1">
                        <span class="unit">%</span>
                    </div>
                </div>
                
                <div class="input-group">
                    <label>å¹³å‡å®¢å˜ä¾¡ï¼ˆå††ï¼‰</label>
                    <div class="input-with-unit">
                        <input type="number" id="avgOrderValue" value="5000" min="0">
                        <span class="unit">å††</span>
                    </div>
                </div>
                
                <div class="input-group">
                    <label>å•†å“ç‚¹æ•°</label>
                    <div class="input-with-unit">
                        <input type="number" id="productCount" value="500" min="0">
                        <span class="unit">ç‚¹</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>2. å°å…¥ãƒ—ãƒ©ãƒ³ã‚’é¸æŠ</h2>
            <div class="input-grid">
                <div class="input-group">
                    <label>ãƒ—ãƒ©ãƒ³</label>
                    <select id="plan">
                        <option value="300">ãƒ©ã‚¤ãƒˆãƒ—ãƒ©ãƒ³ï¼ˆ300ä¸‡å††ï¼‰</option>
                        <option value="500" selected>ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ãƒ—ãƒ©ãƒ³ï¼ˆ500ä¸‡å††ï¼‰- æ¨å¥¨</option>
                        <option value="800">ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ï¼ˆ800ä¸‡å††ï¼‰</option>
                        <option value="custom">ã‚«ã‚¹ã‚¿ãƒ </option>
                    </select>
                </div>
                
                <div class="input-group" id="customPriceGroup" style="display: none;">
                    <label>ã‚«ã‚¹ã‚¿ãƒ åˆæœŸè²»ç”¨ï¼ˆä¸‡å††ï¼‰</label>
                    <div class="input-with-unit">
                        <input type="number" id="customPrice" value="500" min="0">
                        <span class="unit">ä¸‡å††</span>
                    </div>
                </div>
                
                <div class="input-group">
                    <label>æœˆé¡ä¿å®ˆè²»ç”¨ï¼ˆä¸‡å††ï¼‰</label>
                    <div class="input-with-unit">
                        <input type="number" id="monthlyCost" value="10" min="0">
                        <span class="unit">ä¸‡å††</span>
                    </div>
                </div>
                
                <div class="input-group">
                    <label>æœŸå¾…åŠ¹æœï¼ˆå£²ä¸Šå‘ä¸Šç‡ï¼‰</label>
                    <select id="effectRate">
                        <option value="15">ä¿å®ˆçš„ï¼ˆ+15%ï¼‰</option>
                        <option value="20">ã‚„ã‚„ä¿å®ˆçš„ï¼ˆ+20%ï¼‰</option>
                        <option value="25" selected>æ¨™æº–ï¼ˆ+25%ï¼‰</option>
                        <option value="30">æ¥½è¦³çš„ï¼ˆ+30%ï¼‰</option>
                        <option value="35">ã‹ãªã‚Šæ¥½è¦³çš„ï¼ˆ+35%ï¼‰</option>
                    </select>
                </div>
            </div>
        </div>
        
        <button class="calculate-btn" onclick="calculate()">ğŸ’¡ ROIã‚’è¨ˆç®—ã™ã‚‹</button>
        
        <div class="results" id="results">
            <div class="section">
                <h2>ğŸ“ˆ å°å…¥åŠ¹æœã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
                
                <div class="result-cards">
                    <div class="result-card">
                        <h3>ç¾åœ¨ã®æœˆé–“ç²—åˆ©</h3>
                        <div class="value" id="currentProfit">-</div>
                        <div class="subvalue">ä¸‡å††/æœˆ</div>
                    </div>
                    
                    <div class="result-card">
                        <h3>å°å…¥å¾Œã®æœˆé–“ç²—åˆ©</h3>
                        <div class="value" id="afterProfit">-</div>
                        <div class="subvalue">ä¸‡å††/æœˆ</div>
                    </div>
                    
                    <div class="result-card highlight">
                        <h3>ç²—åˆ©å¢—åŠ é¡</h3>
                        <div class="value" id="profitIncrease">-</div>
                        <div class="subvalue">ä¸‡å††/æœˆ</div>
                    </div>
                    
                    <div class="result-card highlight">
                        <h3>æŠ•è³‡å›åæœŸé–“</h3>
                        <div class="value" id="paybackPeriod">-</div>
                        <div class="subvalue">ãƒ¶æœˆ</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <h3>å£²ä¸Šãƒ»ç²—åˆ©ã®å¤‰åŒ–</h3>
                    <div class="comparison-bars">
                        <div class="bar-group">
                            <div class="bar" id="salesBefore" style="height: 0;">
                                <div class="bar-label" id="salesBeforeLabel">-</div>
                            </div>
                            <div class="bar-title">ç¾åœ¨ã®æœˆå•†</div>
                        </div>
                        <div class="bar-group">
                            <div class="bar after" id="salesAfter" style="height: 0;">
                                <div class="bar-label" id="salesAfterLabel">-</div>
                            </div>
                            <div class="bar-title">å°å…¥å¾Œã®æœˆå•†</div>
                        </div>
                        <div class="bar-group">
                            <div class="bar" id="profitBefore" style="height: 0;">
                                <div class="bar-label" id="profitBeforeLabel">-</div>
                            </div>
                            <div class="bar-title">ç¾åœ¨ã®ç²—åˆ©</div>
                        </div>
                        <div class="bar-group">
                            <div class="bar after" id="profitAfter" style="height: 0;">
                                <div class="bar-label" id="profitAfterLabel">-</div>
                            </div>
                            <div class="bar-title">å°å…¥å¾Œã®ç²—åˆ©</div>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <h3>å¹´é–“ã§ã®æŠ•è³‡å¯¾åŠ¹æœ</h3>
                    <table class="scenario-table">
                        <thead>
                            <tr>
                                <th>é …ç›®</th>
                                <th>é‡‘é¡</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>åˆæœŸæŠ•è³‡</td>
                                <td id="initialInvestment">-</td>
                            </tr>
                            <tr>
                                <td>å¹´é–“ä¿å®ˆè²»ç”¨</td>
                                <td id="annualMaintenance">-</td>
                            </tr>
                            <tr>
                                <td>åˆå¹´åº¦ç·ã‚³ã‚¹ãƒˆ</td>
                                <td id="firstYearCost">-</td>
                            </tr>
                            <tr class="best">
                                <td><strong>å¹´é–“ç²—åˆ©å¢—åŠ </strong></td>
                                <td id="annualProfitIncrease"><strong>-</strong></td>
                            </tr>
                            <tr class="best">
                                <td><strong>åˆå¹´åº¦ç´”åˆ©ç›Š</strong></td>
                                <td id="firstYearNetProfit"><strong>-</strong></td>
                            </tr>
                            <tr class="best">
                                <td><strong>2å¹´ç›®ä»¥é™ã®å¹´é–“åˆ©ç›Š</strong></td>
                                <td id="secondYearProfit"><strong>-</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="chart-container">
                    <h3>ã‚·ãƒŠãƒªã‚ªåˆ¥ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h3>
                    <table class="scenario-table">
                        <thead>
                            <tr>
                                <th>ã‚·ãƒŠãƒªã‚ª</th>
                                <th>å£²ä¸Šå‘ä¸Šç‡</th>
                                <th>æœˆé–“ç²—åˆ©å¢—åŠ </th>
                                <th>æŠ•è³‡å›åæœŸé–“</th>
                                <th>å¹´é–“ç´”åˆ©ç›Š</th>
                            </tr>
                        </thead>
                        <tbody id="scenarioTableBody">
                        </tbody>
                    </table>
                </div>
                
                <div class="recommendation" id="recommendation">
                </div>
                
                <div class="info-box">
                    <h4>ğŸ’¡ è¨ˆç®—ã®å‰ææ¡ä»¶</h4>
                    <p>
                        â€¢ å£²ä¸Šå‘ä¸Šç‡ã¯è³¼å…¥ç‡ã¨å®¢å˜ä¾¡ã®ä¸¡æ–¹ã®æ”¹å–„ã‚’å«ã¿ã¾ã™<br>
                        â€¢ åŠ¹æœã¯å°å…¥å¾Œ3ãƒ¶æœˆã§æ®µéšçš„ã«è¡¨ã‚Œã‚‹ã¨æƒ³å®š<br>
                        â€¢ ç²—åˆ©ç‡ã¯å¤‰å‹•ã—ãªã„ã‚‚ã®ã¨ã—ã¦è¨ˆç®—<br>
                        â€¢ å®Ÿéš›ã®åŠ¹æœã¯æ¥­ç¨®ãƒ»å•†æãƒ»å®Ÿè£…å†…å®¹ã«ã‚ˆã‚Šå¤‰å‹•ã—ã¾ã™<br>
                        â€¢ ã‚ˆã‚Šæ­£ç¢ºãªã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯å€‹åˆ¥ç›¸è«‡ã§ã”æç¤ºã—ã¾ã™
                    </p>
                </div>
                
                <div class="export-buttons">
                    <button class="export-btn" onclick="printReport()">ğŸ–¨ï¸ PDFã§ä¿å­˜</button>
                    <button class="export-btn" onclick="copyToClipboard()">ğŸ“‹ çµæœã‚’ã‚³ãƒ”ãƒ¼</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ãƒ—ãƒ©ãƒ³é¸æŠæ™‚ã®å‡¦ç†
        document.getElementById('plan').addEventListener('change', function() {
            const customGroup = document.getElementById('customPriceGroup');
            if (this.value === 'custom') {
                customGroup.style.display = 'block';
            } else {
                customGroup.style.display = 'none';
            }
        });
        
        function calculate() {
            // å…¥åŠ›å€¤ã®å–å¾—
            const monthlySales = parseFloat(document.getElementById('monthlySales').value);
            const grossMargin = parseFloat(document.getElementById('grossMargin').value) / 100;
            const monthlyVisitors = parseFloat(document.getElementById('monthlyVisitors').value);
            const conversionRate = parseFloat(document.getElementById('conversionRate').value) / 100;
            const avgOrderValue = parseFloat(document.getElementById('avgOrderValue').value);
            const productCount = parseFloat(document.getElementById('productCount').value);
            
            const planValue = document.getElementById('plan').value;
            const initialCost = planValue === 'custom' 
                ? parseFloat(document.getElementById('customPrice').value)
                : parseFloat(planValue);
            const monthlyCost = parseFloat(document.getElementById('monthlyCost').value);
            const effectRate = parseFloat(document.getElementById('effectRate').value) / 100;
            
            // ç¾åœ¨ã®ç²—åˆ©è¨ˆç®—
            const currentMonthlyProfit = monthlySales * grossMargin;
            
            // å°å…¥å¾Œã®å£²ä¸Šãƒ»ç²—åˆ©è¨ˆç®—
            const afterMonthlySales = monthlySales * (1 + effectRate);
            const afterMonthlyProfit = afterMonthlySales * grossMargin;
            
            // ç²—åˆ©å¢—åŠ é¡
            const profitIncrease = afterMonthlyProfit - currentMonthlyProfit;
            
            // æŠ•è³‡å›åæœŸé–“
            const totalFirstYearCost = initialCost + (monthlyCost * 12);
            const annualProfitIncrease = profitIncrease * 12;
            const paybackMonths = (initialCost + monthlyCost) / profitIncrease;
            
            // å¹´é–“ç´”åˆ©ç›Š
            const firstYearNetProfit = annualProfitIncrease - totalFirstYearCost;
            const secondYearProfit = annualProfitIncrease - (monthlyCost * 12);
            
            // çµæœè¡¨ç¤º
            document.getElementById('currentProfit').textContent = currentMonthlyProfit.toFixed(0);
            document.getElementById('afterProfit').textContent = afterMonthlyProfit.toFixed(0);
            document.getElementById('profitIncrease').textContent = profitIncrease.toFixed(0);
            document.getElementById('paybackPeriod').textContent = paybackMonths.toFixed(1);
            
            document.getElementById('initialInvestment').textContent = initialCost.toFixed(0) + 'ä¸‡å††';
            document.getElementById('annualMaintenance').textContent = (monthlyCost * 12).toFixed(0) + 'ä¸‡å††';
            document.getElementById('firstYearCost').textContent = totalFirstYearCost.toFixed(0) + 'ä¸‡å††';
            document.getElementById('annualProfitIncrease').textContent = annualProfitIncrease.toFixed(0) + 'ä¸‡å††';
            document.getElementById('firstYearNetProfit').textContent = firstYearNetProfit.toFixed(0) + 'ä¸‡å††';
            document.getElementById('secondYearProfit').textContent = secondYearProfit.toFixed(0) + 'ä¸‡å††';
            
            // ã‚°ãƒ©ãƒ•æç”»
            const maxValue = Math.max(monthlySales, afterMonthlySales, currentMonthlyProfit, afterMonthlyProfit);
            
            setTimeout(() => {
                document.getElementById('salesBefore').style.height = (monthlySales / maxValue * 250) + 'px';
                document.getElementById('salesAfter').style.height = (afterMonthlySales / maxValue * 250) + 'px';
                document.getElementById('profitBefore').style.height = (currentMonthlyProfit / maxValue * 250) + 'px';
                document.getElementById('profitAfter').style.height = (afterMonthlyProfit / maxValue * 250) + 'px';
                
                document.getElementById('salesBeforeLabel').textContent = monthlySales.toFixed(0) + 'ä¸‡';
                document.getElementById('salesAfterLabel').textContent = afterMonthlySales.toFixed(0) + 'ä¸‡';
                document.getElementById('profitBeforeLabel').textContent = currentMonthlyProfit.toFixed(0) + 'ä¸‡';
                document.getElementById('profitAfterLabel').textContent = afterMonthlyProfit.toFixed(0) + 'ä¸‡';
            }, 100);
            
            // ã‚·ãƒŠãƒªã‚ªãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
            const scenarios = [
                { name: 'ä¿å®ˆçš„', rate: 0.15 },
                { name: 'ã‚„ã‚„ä¿å®ˆçš„', rate: 0.20 },
                { name: 'æ¨™æº–', rate: 0.25 },
                { name: 'æ¥½è¦³çš„', rate: 0.30 },
                { name: 'ã‹ãªã‚Šæ¥½è¦³çš„', rate: 0.35 }
            ];
            
            let scenarioHTML = '';
            scenarios.forEach(scenario => {
                const scenarioSales = monthlySales * (1 + scenario.rate);
                const scenarioProfit = scenarioSales * grossMargin;
                const scenarioProfitIncrease = scenarioProfit - currentMonthlyProfit;
                const scenarioPayback = (initialCost + monthlyCost) / scenarioProfitIncrease;
                const scenarioAnnualProfit = (scenarioProfitIncrease * 12) - totalFirstYearCost;
                
                scenarioHTML += `
                    <tr>
                        <td>${scenario.name}</td>
                        <td>+${(scenario.rate * 100).toFixed(0)}%</td>
                        <td>${scenarioProfitIncrease.toFixed(0)}ä¸‡å††</td>
                        <td>${scenarioPayback.toFixed(1)}ãƒ¶æœˆ</td>
                        <td>${scenarioAnnualProfit.toFixed(0)}ä¸‡å††</td>
                    </tr>
                `;
            });
            document.getElementById('scenarioTableBody').innerHTML = scenarioHTML;
            
            // æ¨å¥¨æ–‡è¨€ä½œæˆ
            let recommendation = '';
            if (monthlySales < 300) {
                recommendation = `
                    <h3>âš ï¸ æ¤œè¨ã®æ¨å¥¨</h3>
                    <p>ç¾åœ¨ã®æœˆå•†ã§ã¯æŠ•è³‡å›åã«${paybackMonths.toFixed(1)}ãƒ¶æœˆã‹ã‹ã‚Šã¾ã™ã€‚ã¾ãšã¯æœˆå•†300ä¸‡å††ä»¥ä¸Šã‚’ç›®æŒ‡ã™ã‹ã€ã‚ˆã‚Šä½ã‚³ã‚¹ãƒˆãªãƒãƒ¼ã‚³ãƒ¼ãƒ‰ãƒ„ãƒ¼ãƒ«ã®æ´»ç”¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚æœˆå•†ãŒæˆé•·ã—ãŸæ®µéšã§æœ¬æ ¼çš„ãªãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰æ©Ÿèƒ½ã®å°å…¥ã‚’ã”æ¤œè¨ãã ã•ã„ã€‚</p>
                `;
            } else if (monthlySales >= 300 && monthlySales < 500) {
                recommendation = `
                    <h3>ğŸ’¡ å°å…¥ã‚’æ¤œè¨ã™ã‚‹ä¾¡å€¤ã‚ã‚Š</h3>
                    <p>æŠ•è³‡å›åæœŸé–“ã¯${paybackMonths.toFixed(1)}ãƒ¶æœˆã§ã™ã€‚ãƒ©ã‚¤ãƒˆãƒ—ãƒ©ãƒ³ã‹ã‚‰å§‹ã‚ã¦ã€åŠ¹æœã‚’ç¢ºèªã—ãªãŒã‚‰æ©Ÿèƒ½ã‚’æ‹¡å¼µã—ã¦ã„ãã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚ã¾ãšã¯ç„¡æ–™ç›¸è«‡ã§è©³ç´°ãªã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚</p>
                `;
            } else if (monthlySales >= 500 && monthlySales < 1000) {
                recommendation = `
                    <h3>âœ… å°å…¥ã‚’å¼·ãæ¨å¥¨</h3>
                    <p>æŠ•è³‡å›åæœŸé–“ã¯${paybackMonths.toFixed(1)}ãƒ¶æœˆã§ã€å¹´é–“${firstYearNetProfit.toFixed(0)}ä¸‡å††ã®ç´”åˆ©ç›ŠãŒè¦‹è¾¼ã‚ã¾ã™ã€‚ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ãƒ—ãƒ©ãƒ³ã§ä¸»è¦æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã€ç¶™ç¶šçš„ãªæ”¹å–„ã§åŠ¹æœã‚’æœ€å¤§åŒ–ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚</p>
                `;
            } else {
                recommendation = `
                    <h3>ğŸ¯ ä»Šã™ãå°å…¥ã™ã¹ã</h3>
                    <p>æŠ•è³‡å›åæœŸé–“ã¯ã‚ãšã‹${paybackMonths.toFixed(1)}ãƒ¶æœˆã§ã€å¹´é–“${firstYearNetProfit.toFixed(0)}ä¸‡å††ã®ç´”åˆ©ç›ŠãŒæœŸå¾…ã§ãã¾ã™ã€‚ã“ã®è¦æ¨¡ã§ã‚ã‚Œã°ã€ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã§å…¨æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã€ç”»åƒæ¤œç´¢ãªã©ã®é«˜åº¦ãªæ©Ÿèƒ½ã‚‚å«ã‚ãŸæœ€å¤§é™ã®åŠ¹æœã‚’ç‹™ã†ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚2å¹´ç›®ä»¥é™ã¯å¹´é–“${secondYearProfit.toFixed(0)}ä¸‡å††ã®ç¶™ç¶šçš„ãªåˆ©ç›ŠãŒè¦‹è¾¼ã‚ã¾ã™ã€‚</p>
                `;
            }
            document.getElementById('recommendation').innerHTML = recommendation;
            
            // çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤º
            document.getElementById('results').classList.add('show');
            
            // çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
            document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        
        function printReport() {
            window.print();
        }
        
        function copyToClipboard() {
            const monthlySales = document.getElementById('monthlySales').value;
            const currentProfit = document.getElementById('currentProfit').textContent;
            const afterProfit = document.getElementById('afterProfit').textContent;
            const profitIncrease = document.getElementById('profitIncrease').textContent;
            const paybackPeriod = document.getElementById('paybackPeriod').textContent;
            const annualProfitIncrease = document.getElementById('annualProfitIncrease').textContent;
            const firstYearNetProfit = document.getElementById('firstYearNetProfit').textContent;
            
            const text = `
ã€ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰æ©Ÿèƒ½å°å…¥ ROIã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœã€‘

ç¾åœ¨ã®æœˆå•†: ${monthlySales}ä¸‡å††
ç¾åœ¨ã®æœˆé–“ç²—åˆ©: ${currentProfit}ä¸‡å††
å°å…¥å¾Œã®æœˆé–“ç²—åˆ©: ${afterProfit}ä¸‡å††
ç²—åˆ©å¢—åŠ é¡: ${profitIncrease}ä¸‡å††/æœˆ
æŠ•è³‡å›åæœŸé–“: ${paybackPeriod}ãƒ¶æœˆ
å¹´é–“ç²—åˆ©å¢—åŠ : ${annualProfitIncrease}
åˆå¹´åº¦ç´”åˆ©ç›Š: ${firstYearNetProfit}

â€»è©³ç´°ãªææ¡ˆã¯å€‹åˆ¥ç›¸è«‡ã«ã¦ä½œæˆã„ãŸã—ã¾ã™
            `.trim();
            
            navigator.clipboard.writeText(text).then(() => {
                alert('çµæœã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
            }).catch(() => {
                alert('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚');
            });
        }
    </script>
</body>
</html>